% generated by plotdistinguisher.py
\documentclass[preview]{standalone}
\usepackage{twine}
\usepackage[margin=2.65in]{geometry}
%\tikzset{twinefig/.append style={white}}
\begin{document}
\begin{figure}[htp!]
\begin{tikzpicture}[twinefig]
\foreach \z in {4,5,6,7,8,9,10,11,12,13,14,15,24,25,26,27,28,29,30,31} { \fill[red] (.25*\z,.75) circle[radius=3pt]; }
   \foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
       \draw[gray] (\z,0) node[above] {\tiny\zf};
       \foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\end{tikzpicture}
\twineroundwokey{%s
\markevenbranches{2/1,6/3}{markupperpath}{->}
\markoddbranchbeforexor{1,3,7}{markupperpath}
\markoddbranchafterxor{1/0}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{0/5}{markupperpath}{->}
\markoddbranchbeforexor{1,3}{markupperpath}
\markoddbranchafterxor{3/4}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{4/7}{markupperpath}{->}
\markoddbranchbeforexor{5}{markupperpath}
\markoddbranchafterxor{}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{}{markupperpath}{->}
\markoddbranchbeforexor{7}{markupperpath}
\markoddbranchafterxor{7/8}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{8/13}{markmidupperpath}{->}
\markoddbranchbeforexor{}{markmidupperpath}
\markoddbranchafterxor{9/6}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{4}
}
\twineroundwokey{%s
\markevenbranches{6/3}{markmidupperpath}{->}
\markoddbranchbeforexor{13}{markmidupperpath}
\markoddbranchafterxor{7/8,13/10}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10}{markmidlowerpath}{<-}
\markcommonactivesboxes{3}
}
\twineroundwokey{%s
\markevenbranches{8/13,10/9}{markmidupperpath}{->}
\markoddbranchbeforexor{3}{markmidupperpath}
\markoddbranchafterxor{3/4,9/6,11/2}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{5/12,7/8,9/6,11/2,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{4,5}
}
\twineroundwokey{%s
\markevenbranches{2/1,4/7,6/3}{markmidupperpath}{->}
\markoddbranchbeforexor{9,13}{markmidupperpath}
\markoddbranchafterxor{3/4,5/12,7/8,9/6,13/10}{markmidupperpath}{->}
\markevenbranches{2/1,6/3,8/13,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,5/12,13/10}{markmidlowerpath}{<-}
\markcommonactivesboxes{1,3}
}
\twineroundwokey{%s
\markevenbranches{4/7,6/3,8/13,10/9,12/15}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,7}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10}{markmidupperpath}{->}
\markevenbranches{0/5,10/9,12/15}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{3/4,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{5,6}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15}{markmidupperpath}{->}
\markoddbranchbeforexor{3,7,9,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{4/7,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{5,9,15}{markmidlowerpath}
\markoddbranchafterxor{9/6}{markmidlowerpath}{<-}
\markcommonactivesboxes{2}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{6/3}{markmidlowerpath}{<-}
\markoddbranchbeforexor{7,11}{markmidlowerpath}
\markoddbranchafterxor{11/2}{markmidlowerpath}{<-}
\markcommonactivesboxes{3}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{2/1}{markmidlowerpath}{<-}
\markoddbranchbeforexor{3}{markmidlowerpath}
\markoddbranchafterxor{}{markmidlowerpath}{<-}
\markcommonactivesboxes{1}
}
\twineroundwokey{%s
\markuppercrossingdifferences{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}
\markevenbranches{}{marklowerpath}{<-}
\markoddbranchbeforexor{1}{marklowerpath}
\markoddbranchafterxor{1/0}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{0/5}{marklowerpath}{<-}
\markoddbranchbeforexor{}{marklowerpath}
\markoddbranchafterxor{1/0}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{0/5}{marklowerpath}{<-}
\markoddbranchbeforexor{5}{marklowerpath}
\markoddbranchafterxor{1/0,5/12}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{0/5,12/15}{marklowerpath}{<-}
\markoddbranchbeforexor{5}{marklowerpath}
\markoddbranchafterxor{1/0,5/12,13/10}{marklowerpath}{<-}
\markoutputdiff{0,5,10,12,15}
}
\begin{tikzpicture}[twinefig]
\foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
\draw[gray] (\z,-3pt) node[below] {\tiny\zf};
\foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\foreach \z in {0,1,2,3,20,21,22,23,40,41,42,43,48,49,50,51,60,61,62,63} { \fill[blue] (.25*\z,-.75) circle[radius=3pt]; }
\end{tikzpicture}
\caption{Boomerang distinguisher for 16 rounds of \texttt{TWINE}.}
\label{fig:boomerang_distinguisher}
\end{figure}
\end{document}
