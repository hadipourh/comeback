% generated by plotdistinguisher.py
\documentclass[preview]{standalone}
\usepackage{twine}
\usepackage[margin=2.65in]{geometry}
%\tikzset{twinefig/.append style={white}}
\begin{document}
\begin{figure}[htp!]
\begin{tikzpicture}[twinefig]
\foreach \z in {0,1,2,3,4,5,6,7,28,29,30,31,40,41,42,43,44,45,46,47} { \fill[red] (.25*\z,.75) circle[radius=3pt]; }
   \foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
       \draw[gray] (\z,0) node[above] {\tiny\zf};
       \foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\end{tikzpicture}
\twineroundwokey{%s
\markevenbranches{0/5,10/9}{markupperpath}{->}
\markoddbranchbeforexor{1,7,11}{markupperpath}
\markoddbranchafterxor{7/8}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{8/13}{markupperpath}{->}
\markoddbranchbeforexor{5,9}{markupperpath}
\markoddbranchafterxor{5/12}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{12/15}{markupperpath}{->}
\markoddbranchbeforexor{13}{markupperpath}
\markoddbranchafterxor{}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{}{markupperpath}{->}
\markoddbranchbeforexor{15}{markupperpath}
\markoddbranchafterxor{15/14}{markupperpath}{->}
}
\twineroundwokey{%s
\markevenbranches{14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{}{markmidupperpath}
\markoddbranchafterxor{15/14}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{7}
}
\twineroundwokey{%s
\markevenbranches{14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{11}{markmidupperpath}
\markoddbranchafterxor{11/2,15/14}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,5/12,7/8,9/6,11/2,13/10,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{7}
}
\twineroundwokey{%s
\markevenbranches{2/1,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{11}{markmidupperpath}
\markoddbranchafterxor{3/4,11/2,15/14}{markmidupperpath}{->}
\markevenbranches{0/5,2/1,6/3,8/13,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{1/0,3/4,5/12,13/10,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{1,7}
}
\twineroundwokey{%s
\markevenbranches{2/1,4/7,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,11}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,11/2,15/14}{markmidupperpath}{->}
\markevenbranches{0/5,4/7,10/9,12/15,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3,5,9,11,13,15}{markmidlowerpath}
\markoddbranchafterxor{3/4,9/6,15/14}{markmidlowerpath}{<-}
\markcommonactivesboxes{2,7}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,7,11}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{4/7,6/3,14/11}{markmidlowerpath}{<-}
\markoddbranchbeforexor{5,7,9,11,15}{markmidlowerpath}
\markoddbranchafterxor{9/6,11/2}{markmidlowerpath}{<-}
\markcommonactivesboxes{2,7}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,5,7,11,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{2/1,6/3}{markmidlowerpath}{<-}
\markoddbranchbeforexor{3,7,11}{markmidlowerpath}
\markoddbranchafterxor{11/2}{markmidlowerpath}{<-}
\markcommonactivesboxes{1}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{2/1}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1,3}{markmidlowerpath}
\markoddbranchafterxor{1/0}{markmidlowerpath}{<-}
\markcommonactivesboxes{1}
}
\twineroundwokey{%s
\markevenbranches{0/5,2/1,4/7,6/3,8/13,10/9,12/15,14/11}{markmidupperpath}{->}
\markoddbranchbeforexor{1,3,5,7,9,11,13,15}{markmidupperpath}
\markoddbranchafterxor{1/0,3/4,5/12,7/8,9/6,11/2,13/10,15/14}{markmidupperpath}{->}
\markevenbranches{0/5}{markmidlowerpath}{<-}
\markoddbranchbeforexor{1}{markmidlowerpath}
\markoddbranchafterxor{}{markmidlowerpath}{<-}
\markcommonactivesboxes{0}
}
\twineroundwokey{%s
\markuppercrossingdifferences{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}
\markevenbranches{}{marklowerpath}{<-}
\markoddbranchbeforexor{5}{marklowerpath}
\markoddbranchafterxor{5/12}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{12/15}{marklowerpath}{<-}
\markoddbranchbeforexor{}{marklowerpath}
\markoddbranchafterxor{13/10}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{10/9}{marklowerpath}{<-}
\markoddbranchbeforexor{15}{marklowerpath}
\markoddbranchafterxor{11/2,15/14}{marklowerpath}{<-}
}
\twineroundwokey{%s
\markevenbranches{2/1,14/11}{marklowerpath}{<-}
\markoddbranchbeforexor{9}{marklowerpath}
\markoddbranchafterxor{3/4,9/6,15/14}{marklowerpath}{<-}
\markoutputdiff{1,4,6,11,14}
}
\begin{tikzpicture}[twinefig]
\foreach \z[evaluate=\z as \zf using int(4*\z)] in {0,...,15} {
\draw[gray] (\z,-3pt) node[below] {\tiny\zf};
\foreach \zb in {0,...,3} { \draw[gray] (\z+.25*\zb,0) -- +(0,-3pt); }
}
\foreach \z in {4,5,6,7,16,17,18,19,24,25,26,27,44,45,46,47,56,57,58,59} { \fill[blue] (.25*\z,-.75) circle[radius=3pt]; }
\end{tikzpicture}
\caption{Boomerang distinguisher for 16 rounds of \texttt{TWINE}.}
\label{fig:boomerang_distinguisher}
\end{figure}
\end{document}
